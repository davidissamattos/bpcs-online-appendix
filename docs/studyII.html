<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Re-analysis 2 | Online appendix for the paper: “Bayesian Paired-Comparison with the bpcs package”</title>
  <meta name="description" content="This is the online appendix for the paper: “Bayesian Paired-Comparison with the bpcs package.”" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Re-analysis 2 | Online appendix for the paper: “Bayesian Paired-Comparison with the bpcs package”" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the online appendix for the paper: “Bayesian Paired-Comparison with the bpcs package.”" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Re-analysis 2 | Online appendix for the paper: “Bayesian Paired-Comparison with the bpcs package”" />
  
  <meta name="twitter:description" content="This is the online appendix for the paper: “Bayesian Paired-Comparison with the bpcs package.”" />
  

<meta name="author" content="David Issa Mattos and Érika Martins Silva Ramos" />


<meta name="date" content="2021-06-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="studyI.html"/>
<link rel="next" href="studyIII.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Foreword</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#installation-of-the-bpcs-package"><i class="fa fa-check"></i><b>1.1</b> Installation of the bpcs package</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#session-info"><i class="fa fa-check"></i><b>1.2</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>2</b> Basic functionality</a>
<ul>
<li class="chapter" data-level="2.1" data-path="basics.html"><a href="basics.html#reading-and-preparing-the-data"><i class="fa fa-check"></i><b>2.1</b> Reading and preparing the data</a></li>
<li class="chapter" data-level="2.2" data-path="basics.html"><a href="basics.html#the-bayesian-bradley-terry-analysis"><i class="fa fa-check"></i><b>2.2</b> The Bayesian Bradley-Terry analysis</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="basics.html"><a href="basics.html#diagnostics"><i class="fa fa-check"></i><b>2.2.1</b> Diagnostics</a></li>
<li class="chapter" data-level="2.2.2" data-path="basics.html"><a href="basics.html#summary-information"><i class="fa fa-check"></i><b>2.2.2</b> Summary information</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="studyI.html"><a href="studyI.html"><i class="fa fa-check"></i><b>3</b> Re-analysis 1</a>
<ul>
<li class="chapter" data-level="3.1" data-path="studyI.html"><a href="studyI.html#importing-the-data"><i class="fa fa-check"></i><b>3.1</b> Importing the data</a></li>
<li class="chapter" data-level="3.2" data-path="studyI.html"><a href="studyI.html#analysis-with-the-bradley-terry-model-and-the-order-effect-model"><i class="fa fa-check"></i><b>3.2</b> Analysis with the Bradley-Terry model and the order effect model</a></li>
<li class="chapter" data-level="3.3" data-path="studyI.html"><a href="studyI.html#diagnostics-1"><i class="fa fa-check"></i><b>3.3</b> Diagnostics</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="studyI.html"><a href="studyI.html#tables-and-plots"><i class="fa fa-check"></i><b>3.3.1</b> Tables and plots</a></li>
<li class="chapter" data-level="3.3.2" data-path="studyI.html"><a href="studyI.html#waic"><i class="fa fa-check"></i><b>3.3.2</b> WAIC</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="studyII.html"><a href="studyII.html"><i class="fa fa-check"></i><b>4</b> Re-analysis 2</a>
<ul>
<li class="chapter" data-level="4.1" data-path="studyII.html"><a href="studyII.html#importing-the-data-1"><i class="fa fa-check"></i><b>4.1</b> Importing the data</a></li>
<li class="chapter" data-level="4.2" data-path="studyII.html"><a href="studyII.html#simple-bradley-terry-model"><i class="fa fa-check"></i><b>4.2</b> Simple Bradley-Terry model</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="studyII.html"><a href="studyII.html#assessing-the-fitness-of-the-model"><i class="fa fa-check"></i><b>4.2.1</b> Assessing the fitness of the model</a></li>
<li class="chapter" data-level="4.2.2" data-path="studyII.html"><a href="studyII.html#getting-the-waic"><i class="fa fa-check"></i><b>4.2.2</b> Getting the WAIC</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="studyII.html"><a href="studyII.html#bradley-terry-model-with-random-effects-for-individuals"><i class="fa fa-check"></i><b>4.3</b> Bradley-Terry model with random effects for individuals</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="studyII.html"><a href="studyII.html#getting-the-waic-1"><i class="fa fa-check"></i><b>4.3.1</b> Getting the WAIC</a></li>
<li class="chapter" data-level="4.3.2" data-path="studyII.html"><a href="studyII.html#parameter-tables-and-plots"><i class="fa fa-check"></i><b>4.3.2</b> Parameter tables and plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="studyIII.html"><a href="studyIII.html"><i class="fa fa-check"></i><b>5</b> Re-analysis 3</a>
<ul>
<li class="chapter" data-level="5.1" data-path="studyIII.html"><a href="studyIII.html#importing-the-data-2"><i class="fa fa-check"></i><b>5.1</b> Importing the data</a></li>
<li class="chapter" data-level="5.2" data-path="studyIII.html"><a href="studyIII.html#simple-bradley-terry-models"><i class="fa fa-check"></i><b>5.2</b> Simple Bradley-Terry models</a></li>
<li class="chapter" data-level="5.3" data-path="studyIII.html"><a href="studyIII.html#subject-predictors-model"><i class="fa fa-check"></i><b>5.3</b> Subject predictors model</a></li>
<li class="chapter" data-level="5.4" data-path="studyIII.html"><a href="studyIII.html#subject-predictors-and-random-effects"><i class="fa fa-check"></i><b>5.4</b> Subject predictors and random effects</a></li>
<li class="chapter" data-level="5.5" data-path="studyIII.html"><a href="studyIII.html#comparing-the-waic"><i class="fa fa-check"></i><b>5.5</b> Comparing the WAIC</a></li>
<li class="chapter" data-level="5.6" data-path="studyIII.html"><a href="studyIII.html#plots-and-tables"><i class="fa fa-check"></i><b>5.6</b> Plots and tables</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="studyIII.html"><a href="studyIII.html#table-lambda-and-u"><i class="fa fa-check"></i><b>5.6.1</b> Table lambda and U</a></li>
<li class="chapter" data-level="5.6.2" data-path="studyIII.html"><a href="studyIII.html#subject-predictors-table"><i class="fa fa-check"></i><b>5.6.2</b> Subject predictors table</a></li>
<li class="chapter" data-level="5.6.3" data-path="studyIII.html"><a href="studyIII.html#plot-1"><i class="fa fa-check"></i><b>5.6.3</b> Plot</a></li>
<li class="chapter" data-level="5.6.4" data-path="studyIII.html"><a href="studyIII.html#probability-tables"><i class="fa fa-check"></i><b>5.6.4</b> Probability tables</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Online appendix for the paper: “Bayesian Paired-Comparison with the bpcs package”</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="studyII" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Re-analysis 2</h1>
<p>This reanalysis is based on the paper:</p>
<blockquote>
<p>Huskisson, S.M., Jacobson, S.L., Egelkamp, C.L. et al. Using a Touchscreen Paradigm to Evaluate Food Preferences and Response to Novel Photographic Stimuli of Food in Three Primate Species (Gorilla gorilla gorilla, Pan troglodytes, and Macaca fuscata). Int J Primatol 41, 5–23 (2020). <a href="https://doi.org/10.1007/s10764-020-00131-0" class="uri">https://doi.org/10.1007/s10764-020-00131-0</a></p>
</blockquote>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="studyII.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bpcs)</span>
<span id="cb48-2"><a href="studyII.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb48-3"><a href="studyII.html#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb48-4"><a href="studyII.html#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">99</span>)</span></code></pre></div>
<div id="importing-the-data-1" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Importing the data</h2>
<p>The data from this paper was made available upon request and below we exemplify a few rows of how the original dataset looks like</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="studyII.html#cb49-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&#39;data/touchscreen.csv&#39;</span>)</span></code></pre></div>
<p>Previewing how the data looks like</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="studyII.html#cb50-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">sample_n</span>(d, <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="studyII.html#cb50-2" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption=</span><span class="st">&#39;Sample of how the dataset looks like&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="studyII.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-4"><a href="studyII.html#cb50-4" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">&quot;100%&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-39">Table 4.1: </span>Sample of how the dataset looks like
</caption>
<thead>
<tr>
<th style="text-align:left;">
date
</th>
<th style="text-align:left;">
species_type
</th>
<th style="text-align:left;">
SubjectCode
</th>
<th style="text-align:left;">
Sex
</th>
<th style="text-align:right;">
Trial
</th>
<th style="text-align:left;">
image1
</th>
<th style="text-align:left;">
image2
</th>
<th style="text-align:left;">
image_chosen
</th>
<th style="text-align:left;">
concat_test_name
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1/22/18
</td>
<td style="text-align:left;">
Macaque
</td>
<td style="text-align:left;">
Macaque7
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Ca
</td>
<td style="text-align:left;">
Pe
</td>
<td style="text-align:left;">
Pe
</td>
<td style="text-align:left;">
CaPe
</td>
</tr>
<tr>
<td style="text-align:left;">
1/5/17
</td>
<td style="text-align:left;">
Gorilla
</td>
<td style="text-align:left;">
Gorilla4
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:left;">
Ca
</td>
<td style="text-align:left;">
Tu
</td>
<td style="text-align:left;">
Tu
</td>
<td style="text-align:left;">
CaTu
</td>
</tr>
<tr>
<td style="text-align:left;">
3/3/17
</td>
<td style="text-align:left;">
Chimpanzee
</td>
<td style="text-align:left;">
Chimpanzee1
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
Cu
</td>
<td style="text-align:left;">
Gr
</td>
<td style="text-align:left;">
Gr
</td>
<td style="text-align:left;">
CuGr
</td>
</tr>
<tr>
<td style="text-align:left;">
12/4/17
</td>
<td style="text-align:left;">
Chimpanzee
</td>
<td style="text-align:left;">
Chimpanzee1
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
Ap
</td>
<td style="text-align:left;">
Tu
</td>
<td style="text-align:left;">
Tu
</td>
<td style="text-align:left;">
ApTu
</td>
</tr>
<tr>
<td style="text-align:left;">
5/1/17
</td>
<td style="text-align:left;">
Gorilla
</td>
<td style="text-align:left;">
Gorilla6
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
Ca
</td>
<td style="text-align:left;">
Tu
</td>
<td style="text-align:left;">
Ca
</td>
<td style="text-align:left;">
CaTu
</td>
</tr>
<tr>
<td style="text-align:left;">
8/6/18
</td>
<td style="text-align:left;">
Gorilla
</td>
<td style="text-align:left;">
Gorilla5
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Cu
</td>
<td style="text-align:left;">
To
</td>
<td style="text-align:left;">
To
</td>
<td style="text-align:left;">
CuTo
</td>
</tr>
<tr>
<td style="text-align:left;">
1/31/18
</td>
<td style="text-align:left;">
Gorilla
</td>
<td style="text-align:left;">
Gorilla5
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
Ca
</td>
<td style="text-align:left;">
Cu
</td>
<td style="text-align:left;">
Ca
</td>
<td style="text-align:left;">
CaCu
</td>
</tr>
<tr>
<td style="text-align:left;">
8/3/17
</td>
<td style="text-align:left;">
Gorilla
</td>
<td style="text-align:left;">
Gorilla6
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
Ca
</td>
<td style="text-align:left;">
To
</td>
<td style="text-align:left;">
To
</td>
<td style="text-align:left;">
CaTo
</td>
</tr>
<tr>
<td style="text-align:left;">
4/18/17
</td>
<td style="text-align:left;">
Gorilla
</td>
<td style="text-align:left;">
Gorilla2
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
Ca
</td>
<td style="text-align:left;">
To
</td>
<td style="text-align:left;">
To
</td>
<td style="text-align:left;">
CaTo
</td>
</tr>
<tr>
<td style="text-align:left;">
3/20/17
</td>
<td style="text-align:left;">
Gorilla
</td>
<td style="text-align:left;">
Gorilla2
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
Gr
</td>
<td style="text-align:left;">
To
</td>
<td style="text-align:left;">
Gr
</td>
<td style="text-align:left;">
GrTo
</td>
</tr>
</tbody>
</table>
</div>
<p>Now we need to modify a bit the data frame to create a column with the results as 0 and 1.</p>
<p>Creating a numerical result vector with 0 for image1 and 1 for image2</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="studyII.html#cb51-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="studyII.html#cb51-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">y =</span><span class="fu">ifelse</span>(image_chosen<span class="sc">==</span>image1, <span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<p>Adding names to the abbreviations</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="studyII.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#image1</span></span>
<span id="cb52-2"><a href="studyII.html#cb52-2" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image1 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image1, <span class="st">&quot;Ca&quot;</span> <span class="ot">=</span> <span class="st">&#39;Carrot&#39;</span>)</span>
<span id="cb52-3"><a href="studyII.html#cb52-3" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image1 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image1, <span class="st">&quot;Cu&quot;</span> <span class="ot">=</span> <span class="st">&#39;Cucumber&#39;</span>)</span>
<span id="cb52-4"><a href="studyII.html#cb52-4" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image1 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image1, <span class="st">&quot;Tu&quot;</span> <span class="ot">=</span> <span class="st">&#39;Turnip&#39;</span>)</span>
<span id="cb52-5"><a href="studyII.html#cb52-5" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image1 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image1, <span class="st">&quot;Gr&quot;</span> <span class="ot">=</span> <span class="st">&#39;Grape&#39;</span>)</span>
<span id="cb52-6"><a href="studyII.html#cb52-6" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image1 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image1, <span class="st">&quot;To&quot;</span> <span class="ot">=</span> <span class="st">&#39;Tomato&#39;</span>)</span>
<span id="cb52-7"><a href="studyII.html#cb52-7" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image1 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image1, <span class="st">&quot;Ap&quot;</span> <span class="ot">=</span> <span class="st">&#39;Apple&#39;</span>)</span>
<span id="cb52-8"><a href="studyII.html#cb52-8" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image1 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image1, <span class="st">&quot;Jp&quot;</span> <span class="ot">=</span> <span class="st">&#39;Jungle Pellet&#39;</span>)</span>
<span id="cb52-9"><a href="studyII.html#cb52-9" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image1 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image1, <span class="st">&quot;Ce&quot;</span> <span class="ot">=</span> <span class="st">&#39;Celery&#39;</span>)</span>
<span id="cb52-10"><a href="studyII.html#cb52-10" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image1 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image1, <span class="st">&quot;Gb&quot;</span> <span class="ot">=</span> <span class="st">&#39;Green Beans&#39;</span>)</span>
<span id="cb52-11"><a href="studyII.html#cb52-11" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image1 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image1, <span class="st">&quot;Oa&quot;</span> <span class="ot">=</span> <span class="st">&#39;Oats&#39;</span>)</span>
<span id="cb52-12"><a href="studyII.html#cb52-12" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image1 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image1, <span class="st">&quot;Pe&quot;</span> <span class="ot">=</span> <span class="st">&#39;Peanuts&#39;</span>)</span>
<span id="cb52-13"><a href="studyII.html#cb52-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-14"><a href="studyII.html#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="co">#image2</span></span>
<span id="cb52-15"><a href="studyII.html#cb52-15" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image2, <span class="st">&quot;Ca&quot;</span> <span class="ot">=</span> <span class="st">&#39;Carrot&#39;</span>)</span>
<span id="cb52-16"><a href="studyII.html#cb52-16" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image2, <span class="st">&quot;Cu&quot;</span> <span class="ot">=</span> <span class="st">&#39;Cucumber&#39;</span>)</span>
<span id="cb52-17"><a href="studyII.html#cb52-17" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image2, <span class="st">&quot;Tu&quot;</span> <span class="ot">=</span> <span class="st">&#39;Turnip&#39;</span>)</span>
<span id="cb52-18"><a href="studyII.html#cb52-18" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image2, <span class="st">&quot;Gr&quot;</span> <span class="ot">=</span> <span class="st">&#39;Grape&#39;</span>)</span>
<span id="cb52-19"><a href="studyII.html#cb52-19" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image2, <span class="st">&quot;To&quot;</span> <span class="ot">=</span> <span class="st">&#39;Tomato&#39;</span>)</span>
<span id="cb52-20"><a href="studyII.html#cb52-20" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image2, <span class="st">&quot;Ap&quot;</span> <span class="ot">=</span> <span class="st">&#39;Apple&#39;</span>)</span>
<span id="cb52-21"><a href="studyII.html#cb52-21" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image2, <span class="st">&quot;Jp&quot;</span> <span class="ot">=</span> <span class="st">&#39;Jungle Pellet&#39;</span>)</span>
<span id="cb52-22"><a href="studyII.html#cb52-22" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image2, <span class="st">&quot;Ce&quot;</span> <span class="ot">=</span> <span class="st">&#39;Celery&#39;</span>)</span>
<span id="cb52-23"><a href="studyII.html#cb52-23" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image2, <span class="st">&quot;Gb&quot;</span> <span class="ot">=</span> <span class="st">&#39;Green Beans&#39;</span>)</span>
<span id="cb52-24"><a href="studyII.html#cb52-24" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image2, <span class="st">&quot;Oa&quot;</span> <span class="ot">=</span> <span class="st">&#39;Oats&#39;</span>)</span>
<span id="cb52-25"><a href="studyII.html#cb52-25" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>image2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(d<span class="sc">$</span>image2, <span class="st">&quot;Pe&quot;</span> <span class="ot">=</span> <span class="st">&#39;Peanuts&#39;</span>)</span></code></pre></div>
<p>Separating the data into three datasets. One for each species.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="studyII.html#cb53-1" aria-hidden="true" tabindex="-1"></a>macaque <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="studyII.html#cb53-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(species_type<span class="sc">==</span><span class="st">&#39;Macaque&#39;</span>)</span>
<span id="cb53-3"><a href="studyII.html#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="studyII.html#cb53-4" aria-hidden="true" tabindex="-1"></a>chip <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb53-5"><a href="studyII.html#cb53-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(species_type<span class="sc">==</span><span class="st">&#39;Chimpanzee&#39;</span>)</span>
<span id="cb53-6"><a href="studyII.html#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="studyII.html#cb53-7" aria-hidden="true" tabindex="-1"></a>gor <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb53-8"><a href="studyII.html#cb53-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(species_type<span class="sc">==</span><span class="st">&#39;Gorilla&#39;</span>)</span></code></pre></div>
<p>Below we show a few lines of each dataset:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="studyII.html#cb54-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">sample_n</span>(gor, <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="studyII.html#cb54-2" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption=</span><span class="st">&#39;Sample of how the gorilla dataset looks like&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-3"><a href="studyII.html#cb54-3" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href="studyII.html#cb54-4" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">&quot;100%&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-43">Table 4.2: </span>Sample of how the gorilla dataset looks like
</caption>
<thead>
<tr>
<th style="text-align:left;">
date
</th>
<th style="text-align:left;">
species_type
</th>
<th style="text-align:left;">
SubjectCode
</th>
<th style="text-align:left;">
Sex
</th>
<th style="text-align:right;">
Trial
</th>
<th style="text-align:left;">
image1
</th>
<th style="text-align:left;">
image2
</th>
<th style="text-align:left;">
image_chosen
</th>
<th style="text-align:left;">
concat_test_name
</th>
<th style="text-align:right;">
y
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
8/3/17
</td>
<td style="text-align:left;">
Gorilla
</td>
<td style="text-align:left;">
Gorilla6
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
Carrot
</td>
<td style="text-align:left;">
Tomato
</td>
<td style="text-align:left;">
To
</td>
<td style="text-align:left;">
CaTo
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
8/23/17
</td>
<td style="text-align:left;">
Gorilla
</td>
<td style="text-align:left;">
Gorilla5
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:left;">
Cucumber
</td>
<td style="text-align:left;">
Grape
</td>
<td style="text-align:left;">
Gr
</td>
<td style="text-align:left;">
CuGr
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
12/7/16
</td>
<td style="text-align:left;">
Gorilla
</td>
<td style="text-align:left;">
Gorilla2
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:left;">
Cucumber
</td>
<td style="text-align:left;">
Turnip
</td>
<td style="text-align:left;">
Cu
</td>
<td style="text-align:left;">
CuTu
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
5/25/17
</td>
<td style="text-align:left;">
Gorilla
</td>
<td style="text-align:left;">
Gorilla1
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
Carrot
</td>
<td style="text-align:left;">
Cucumber
</td>
<td style="text-align:left;">
Ca
</td>
<td style="text-align:left;">
CaCu
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
11/3/16
</td>
<td style="text-align:left;">
Gorilla
</td>
<td style="text-align:left;">
Gorilla4
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Carrot
</td>
<td style="text-align:left;">
Grape
</td>
<td style="text-align:left;">
Ca
</td>
<td style="text-align:left;">
CaGr
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
7/12/17
</td>
<td style="text-align:left;">
Gorilla
</td>
<td style="text-align:left;">
Gorilla3
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Grape
</td>
<td style="text-align:left;">
Tomato
</td>
<td style="text-align:left;">
Gr
</td>
<td style="text-align:left;">
GrTo
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
1/24/17
</td>
<td style="text-align:left;">
Gorilla
</td>
<td style="text-align:left;">
Gorilla5
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
Carrot
</td>
<td style="text-align:left;">
Grape
</td>
<td style="text-align:left;">
Ca
</td>
<td style="text-align:left;">
CaGr
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
11/15/17
</td>
<td style="text-align:left;">
Gorilla
</td>
<td style="text-align:left;">
Gorilla1
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
Grape
</td>
<td style="text-align:left;">
Tomato
</td>
<td style="text-align:left;">
Gr
</td>
<td style="text-align:left;">
GrTo
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
11/22/17
</td>
<td style="text-align:left;">
Gorilla
</td>
<td style="text-align:left;">
Gorilla6
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:left;">
Apple
</td>
<td style="text-align:left;">
Grape
</td>
<td style="text-align:left;">
Gr
</td>
<td style="text-align:left;">
ApGr
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
10/2/17
</td>
<td style="text-align:left;">
Gorilla
</td>
<td style="text-align:left;">
Gorilla1
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
Apple
</td>
<td style="text-align:left;">
Carrot
</td>
<td style="text-align:left;">
Ca
</td>
<td style="text-align:left;">
ApCa
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="studyII.html#cb55-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">sample_n</span>(chip, <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-2"><a href="studyII.html#cb55-2" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption=</span><span class="st">&#39;Sample of how the chimpanzees dataset looks like&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="studyII.html#cb55-3" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb55-4"><a href="studyII.html#cb55-4" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">&quot;100%&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-44">Table 4.3: </span>Sample of how the chimpanzees dataset looks like
</caption>
<thead>
<tr>
<th style="text-align:left;">
date
</th>
<th style="text-align:left;">
species_type
</th>
<th style="text-align:left;">
SubjectCode
</th>
<th style="text-align:left;">
Sex
</th>
<th style="text-align:right;">
Trial
</th>
<th style="text-align:left;">
image1
</th>
<th style="text-align:left;">
image2
</th>
<th style="text-align:left;">
image_chosen
</th>
<th style="text-align:left;">
concat_test_name
</th>
<th style="text-align:right;">
y
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
7/26/17
</td>
<td style="text-align:left;">
Chimpanzee
</td>
<td style="text-align:left;">
Chimpanzee3
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
Cucumber
</td>
<td style="text-align:left;">
Grape
</td>
<td style="text-align:left;">
Cu
</td>
<td style="text-align:left;">
CuGr
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
10/26/17
</td>
<td style="text-align:left;">
Chimpanzee
</td>
<td style="text-align:left;">
Chimpanzee1
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
Apple
</td>
<td style="text-align:left;">
Grape
</td>
<td style="text-align:left;">
Gr
</td>
<td style="text-align:left;">
ApGr
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
9/18/17
</td>
<td style="text-align:left;">
Chimpanzee
</td>
<td style="text-align:left;">
Chimpanzee4
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
Carrot
</td>
<td style="text-align:left;">
Grape
</td>
<td style="text-align:left;">
Gr
</td>
<td style="text-align:left;">
CaGr
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
12/8/16
</td>
<td style="text-align:left;">
Chimpanzee
</td>
<td style="text-align:left;">
Chimpanzee1
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
Cucumber
</td>
<td style="text-align:left;">
Turnip
</td>
<td style="text-align:left;">
Cu
</td>
<td style="text-align:left;">
CuTu
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
12/14/17
</td>
<td style="text-align:left;">
Chimpanzee
</td>
<td style="text-align:left;">
Chimpanzee3
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
Tomato
</td>
<td style="text-align:left;">
Turnip
</td>
<td style="text-align:left;">
To
</td>
<td style="text-align:left;">
ToTu
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
1/12/17
</td>
<td style="text-align:left;">
Chimpanzee
</td>
<td style="text-align:left;">
Chimpanzee4
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:left;">
Cucumber
</td>
<td style="text-align:left;">
Turnip
</td>
<td style="text-align:left;">
Tu
</td>
<td style="text-align:left;">
CuTu
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
6/14/17
</td>
<td style="text-align:left;">
Chimpanzee
</td>
<td style="text-align:left;">
Chimpanzee3
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
Carrot
</td>
<td style="text-align:left;">
Cucumber
</td>
<td style="text-align:left;">
Ca
</td>
<td style="text-align:left;">
CaCu
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
9/19/17
</td>
<td style="text-align:left;">
Chimpanzee
</td>
<td style="text-align:left;">
Chimpanzee4
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
Carrot
</td>
<td style="text-align:left;">
Grape
</td>
<td style="text-align:left;">
Ca
</td>
<td style="text-align:left;">
CaGr
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
3/5/18
</td>
<td style="text-align:left;">
Chimpanzee
</td>
<td style="text-align:left;">
Chimpanzee4
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:left;">
Apple
</td>
<td style="text-align:left;">
Carrot
</td>
<td style="text-align:left;">
Ap
</td>
<td style="text-align:left;">
ApCa
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
2/7/17
</td>
<td style="text-align:left;">
Chimpanzee
</td>
<td style="text-align:left;">
Chimpanzee2
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:left;">
Grape
</td>
<td style="text-align:left;">
Turnip
</td>
<td style="text-align:left;">
Gr
</td>
<td style="text-align:left;">
GrTu
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="studyII.html#cb56-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">sample_n</span>(macaque, <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-2"><a href="studyII.html#cb56-2" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption=</span><span class="st">&#39;Sample of how the macaques dataset looks like&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-3"><a href="studyII.html#cb56-3" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-4"><a href="studyII.html#cb56-4" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">&quot;100%&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-45">Table 4.4: </span>Sample of how the macaques dataset looks like
</caption>
<thead>
<tr>
<th style="text-align:left;">
date
</th>
<th style="text-align:left;">
species_type
</th>
<th style="text-align:left;">
SubjectCode
</th>
<th style="text-align:left;">
Sex
</th>
<th style="text-align:right;">
Trial
</th>
<th style="text-align:left;">
image1
</th>
<th style="text-align:left;">
image2
</th>
<th style="text-align:left;">
image_chosen
</th>
<th style="text-align:left;">
concat_test_name
</th>
<th style="text-align:right;">
y
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="mailto:05-04-2018@11-27" class="email">05-04-2018@11-27</a>
</td>
<td style="text-align:left;">
Macaque
</td>
<td style="text-align:left;">
Macaque1
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Celery
</td>
<td style="text-align:left;">
Green Beans
</td>
<td style="text-align:left;">
Gb
</td>
<td style="text-align:left;">
GbCe
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
1/16/18
</td>
<td style="text-align:left;">
Macaque
</td>
<td style="text-align:left;">
Macaque7
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
Carrot
</td>
<td style="text-align:left;">
Peanuts
</td>
<td style="text-align:left;">
Ca
</td>
<td style="text-align:left;">
CaPe
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="mailto:04-02-2018@11-27" class="email">04-02-2018@11-27</a>
</td>
<td style="text-align:left;">
Macaque
</td>
<td style="text-align:left;">
Macaque1
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:left;">
Carrot
</td>
<td style="text-align:left;">
Green Beans
</td>
<td style="text-align:left;">
Ca
</td>
<td style="text-align:left;">
GbCa
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
9/7/17
</td>
<td style="text-align:left;">
Macaque
</td>
<td style="text-align:left;">
Macaque6
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Carrot
</td>
<td style="text-align:left;">
Celery
</td>
<td style="text-align:left;">
Ca
</td>
<td style="text-align:left;">
CeCa
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
8/14/17
</td>
<td style="text-align:left;">
Macaque
</td>
<td style="text-align:left;">
Macaque2
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
Carrot
</td>
<td style="text-align:left;">
Peanuts
</td>
<td style="text-align:left;">
Pe
</td>
<td style="text-align:left;">
CaPe
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
5/24/18
</td>
<td style="text-align:left;">
Macaque
</td>
<td style="text-align:left;">
Macaque4
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:left;">
Jungle Pellet
</td>
<td style="text-align:left;">
Oats
</td>
<td style="text-align:left;">
Jp
</td>
<td style="text-align:left;">
JpOa
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="mailto:02-12-2018@11-48" class="email">02-12-2018@11-48</a>
</td>
<td style="text-align:left;">
Macaque
</td>
<td style="text-align:left;">
Macaque1
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:left;">
Peanuts
</td>
<td style="text-align:left;">
Celery
</td>
<td style="text-align:left;">
Ce
</td>
<td style="text-align:left;">
CePe
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
3/26/18
</td>
<td style="text-align:left;">
Macaque
</td>
<td style="text-align:left;">
Macaque7
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
Carrot
</td>
<td style="text-align:left;">
Celery
</td>
<td style="text-align:left;">
Ca
</td>
<td style="text-align:left;">
CeCa
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
8/4/17
</td>
<td style="text-align:left;">
Macaque
</td>
<td style="text-align:left;">
Macaque4
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Jungle Pellet
</td>
<td style="text-align:left;">
Peanuts
</td>
<td style="text-align:left;">
Jp
</td>
<td style="text-align:left;">
JpPe
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
4/19/18
</td>
<td style="text-align:left;">
Macaque
</td>
<td style="text-align:left;">
Macaque4
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:left;">
Peanuts
</td>
<td style="text-align:left;">
Oats
</td>
<td style="text-align:left;">
Pe
</td>
<td style="text-align:left;">
PeOa
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="simple-bradley-terry-model" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Simple Bradley-Terry model</h2>
<p>Now that the data is ready let’s fit three simple Bayesian Bradley-Terry models</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="studyII.html#cb57-1" aria-hidden="true" tabindex="-1"></a>m1_macaque <span class="ot">&lt;-</span></span>
<span id="cb57-2"><a href="studyII.html#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bpc</span>(</span>
<span id="cb57-3"><a href="studyII.html#cb57-3" aria-hidden="true" tabindex="-1"></a>    macaque,</span>
<span id="cb57-4"><a href="studyII.html#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">player0 =</span> <span class="st">&#39;image1&#39;</span>,</span>
<span id="cb57-5"><a href="studyII.html#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">player1 =</span> <span class="st">&#39;image2&#39;</span>,</span>
<span id="cb57-6"><a href="studyII.html#cb57-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">result_column =</span> <span class="st">&#39;y&#39;</span>,</span>
<span id="cb57-7"><a href="studyII.html#cb57-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">model_type =</span> <span class="st">&#39;bt&#39;</span>,</span>
<span id="cb57-8"><a href="studyII.html#cb57-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">priors =</span> <span class="fu">list</span>(<span class="at">prior_lambda_std =</span> <span class="fl">3.0</span>),</span>
<span id="cb57-9"><a href="studyII.html#cb57-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">3000</span>,</span>
<span id="cb57-10"><a href="studyII.html#cb57-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">show_chain_messages =</span> T</span>
<span id="cb57-11"><a href="studyII.html#cb57-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-12"><a href="studyII.html#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="fu">save_bpc_model</span>(m1_macaque, <span class="st">&#39;m1_macaque&#39;</span>, <span class="st">&#39;./fittedmodels&#39;</span>)</span>
<span id="cb57-13"><a href="studyII.html#cb57-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-14"><a href="studyII.html#cb57-14" aria-hidden="true" tabindex="-1"></a>m1_chip <span class="ot">&lt;-</span></span>
<span id="cb57-15"><a href="studyII.html#cb57-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bpc</span>(</span>
<span id="cb57-16"><a href="studyII.html#cb57-16" aria-hidden="true" tabindex="-1"></a>    chip,</span>
<span id="cb57-17"><a href="studyII.html#cb57-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">player0 =</span> <span class="st">&#39;image1&#39;</span>,</span>
<span id="cb57-18"><a href="studyII.html#cb57-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">player1 =</span> <span class="st">&#39;image2&#39;</span>,</span>
<span id="cb57-19"><a href="studyII.html#cb57-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">result_column =</span> <span class="st">&#39;y&#39;</span>,</span>
<span id="cb57-20"><a href="studyII.html#cb57-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">model_type =</span> <span class="st">&#39;bt&#39;</span>,</span>
<span id="cb57-21"><a href="studyII.html#cb57-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">priors =</span> <span class="fu">list</span>(<span class="at">prior_lambda_std =</span> <span class="fl">3.0</span>),</span>
<span id="cb57-22"><a href="studyII.html#cb57-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">3000</span>,</span>
<span id="cb57-23"><a href="studyII.html#cb57-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">show_chain_messages =</span> T</span>
<span id="cb57-24"><a href="studyII.html#cb57-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-25"><a href="studyII.html#cb57-25" aria-hidden="true" tabindex="-1"></a><span class="fu">save_bpc_model</span>(m1_chip, <span class="st">&#39;m1_chip&#39;</span>, <span class="st">&#39;./fittedmodels&#39;</span>)</span>
<span id="cb57-26"><a href="studyII.html#cb57-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-27"><a href="studyII.html#cb57-27" aria-hidden="true" tabindex="-1"></a>m1_gor <span class="ot">&lt;-</span></span>
<span id="cb57-28"><a href="studyII.html#cb57-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bpc</span>(</span>
<span id="cb57-29"><a href="studyII.html#cb57-29" aria-hidden="true" tabindex="-1"></a>    gor,</span>
<span id="cb57-30"><a href="studyII.html#cb57-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">player0 =</span> <span class="st">&#39;image1&#39;</span>,</span>
<span id="cb57-31"><a href="studyII.html#cb57-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">player1 =</span> <span class="st">&#39;image2&#39;</span>,</span>
<span id="cb57-32"><a href="studyII.html#cb57-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">result_column =</span> <span class="st">&#39;y&#39;</span>,</span>
<span id="cb57-33"><a href="studyII.html#cb57-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">model_type =</span> <span class="st">&#39;bt&#39;</span>,</span>
<span id="cb57-34"><a href="studyII.html#cb57-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">priors =</span> <span class="fu">list</span>(<span class="at">prior_lambda_std =</span> <span class="fl">3.0</span>),</span>
<span id="cb57-35"><a href="studyII.html#cb57-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">3000</span>,</span>
<span id="cb57-36"><a href="studyII.html#cb57-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">show_chain_messages =</span> T</span>
<span id="cb57-37"><a href="studyII.html#cb57-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-38"><a href="studyII.html#cb57-38" aria-hidden="true" tabindex="-1"></a><span class="fu">save_bpc_model</span>(m1_gor, <span class="st">&#39;m1_gor&#39;</span>, <span class="st">&#39;./fittedmodels&#39;</span>)</span></code></pre></div>
<div id="assessing-the-fitness-of-the-model" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Assessing the fitness of the model</h3>
<p>Here we are illustrating how to conduct the diagnostic analysis for one model only. Since the shinystan app does not appear in the compiled appendix we are just representing it here once for the Chimpanzees model. Note that it is still possible to use the bayesplot package to generate static figures if needed.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="studyII.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#First we get the posterior predictive in the environment</span></span>
<span id="cb58-2"><a href="studyII.html#cb58-2" aria-hidden="true" tabindex="-1"></a>pp_m1_chip <span class="ot">&lt;-</span> <span class="fu">posterior_predictive</span>(m1_chip, <span class="at">n =</span> <span class="dv">100</span>)</span>
<span id="cb58-3"><a href="studyII.html#cb58-3" aria-hidden="true" tabindex="-1"></a>y_pp_m1_chip <span class="ot">&lt;-</span> pp_m1_chip_gor<span class="sc">$</span>y</span>
<span id="cb58-4"><a href="studyII.html#cb58-4" aria-hidden="true" tabindex="-1"></a>ypred_pp_m1_chip <span class="ot">&lt;-</span> pp_m1_chip<span class="sc">$</span>y_pred</span></code></pre></div>
<p>Then we launch shinystan to assess convergence and validity of the model (e.g.)</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="studyII.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">launch_shinystan</span>(m1_chip)</span></code></pre></div>
<p>We can also do some quick checks with:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="studyII.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_convergence_diagnostics</span>(m1_chip)</span></code></pre></div>
<pre><code>## Processing csv files: /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106021838-1-7618ae.csv, /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106021838-2-7618ae.csv, /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106021838-3-7618ae.csv, /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106021838-4-7618ae.csv
## 
## Checking sampler transitions treedepth.
## Treedepth satisfactory for all transitions.
## 
## Checking sampler transitions for divergences.
## No divergent transitions found.
## 
## Checking E-BFMI - sampler transitions HMC potential energy.
## E-BFMI satisfactory for all transitions.
## 
## Effective sample size satisfactory.
## 
## Split R-hat values satisfactory all parameters.
## 
## Processing complete, no problems detected.</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="studyII.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_convergence_diagnostics</span>(m1_macaque)</span></code></pre></div>
<pre><code>## Processing csv files: /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106021755-1-43f436.csv, /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106021755-2-43f436.csv, /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106021755-3-43f436.csv, /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106021755-4-43f436.csv
## 
## Checking sampler transitions treedepth.
## Treedepth satisfactory for all transitions.
## 
## Checking sampler transitions for divergences.
## No divergent transitions found.
## 
## Checking E-BFMI - sampler transitions HMC potential energy.
## E-BFMI satisfactory for all transitions.
## 
## Effective sample size satisfactory.
## 
## Split R-hat values satisfactory all parameters.
## 
## Processing complete, no problems detected.</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="studyII.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_convergence_diagnostics</span>(m1_gor)</span></code></pre></div>
<pre><code>## Processing csv files: /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106021909-1-2d1bbd.csv, /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106021909-2-2d1bbd.csv, /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106021909-3-2d1bbd.csv, /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106021909-4-2d1bbd.csv
## 
## Checking sampler transitions treedepth.
## Treedepth satisfactory for all transitions.
## 
## Checking sampler transitions for divergences.
## No divergent transitions found.
## 
## Checking E-BFMI - sampler transitions HMC potential energy.
## E-BFMI satisfactory for all transitions.
## 
## Effective sample size satisfactory.
## 
## Split R-hat values satisfactory all parameters.
## 
## Processing complete, no problems detected.</code></pre>
</div>
<div id="getting-the-waic" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Getting the WAIC</h3>
<p>Before we start getting the parameters tables and etc let’s get the WAIC so we can compare with the next model (with random effects)</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="studyII.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_waic</span>(m1_macaque)</span></code></pre></div>
<pre><code>## 
## Computed from 12000 by 8400 log-likelihood matrix
## 
##           Estimate    SE
## elpd_waic  -3550.7  56.7
## p_waic         5.0   0.1
## waic        7101.5 113.4</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="studyII.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_waic</span>(m1_chip)</span></code></pre></div>
<pre><code>## 
## Computed from 12000 by 5400 log-likelihood matrix
## 
##           Estimate   SE
## elpd_waic  -3599.7 17.0
## p_waic         5.0  0.0
## waic        7199.4 33.9</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="studyII.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_waic</span>(m1_gor)</span></code></pre></div>
<pre><code>## 
## Computed from 12000 by 8100 log-likelihood matrix
## 
##           Estimate   SE
## elpd_waic  -4883.6 35.9
## p_waic         4.9  0.0
## waic        9767.2 71.9</code></pre>
</div>
</div>
<div id="bradley-terry-model-with-random-effects-for-individuals" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Bradley-Terry model with random effects for individuals</h2>
<p>Let’s add the cluster SubjectCode as a random effects in our model</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="studyII.html#cb72-1" aria-hidden="true" tabindex="-1"></a>m2_macaque <span class="ot">&lt;-</span></span>
<span id="cb72-2"><a href="studyII.html#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bpc</span>(</span>
<span id="cb72-3"><a href="studyII.html#cb72-3" aria-hidden="true" tabindex="-1"></a>    macaque,</span>
<span id="cb72-4"><a href="studyII.html#cb72-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">player0 =</span> <span class="st">&#39;image1&#39;</span>,</span>
<span id="cb72-5"><a href="studyII.html#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">player1 =</span> <span class="st">&#39;image2&#39;</span>,</span>
<span id="cb72-6"><a href="studyII.html#cb72-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">result_column =</span> <span class="st">&#39;y&#39;</span>,</span>
<span id="cb72-7"><a href="studyII.html#cb72-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">model_type =</span> <span class="st">&#39;bt-U&#39;</span>,</span>
<span id="cb72-8"><a href="studyII.html#cb72-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">cluster =</span> <span class="fu">c</span>(<span class="st">&#39;SubjectCode&#39;</span>),</span>
<span id="cb72-9"><a href="studyII.html#cb72-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">priors =</span> <span class="fu">list</span>(</span>
<span id="cb72-10"><a href="studyII.html#cb72-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior_lambda_std =</span> <span class="fl">1.0</span>,</span>
<span id="cb72-11"><a href="studyII.html#cb72-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior_U1_std =</span> <span class="fl">1.0</span></span>
<span id="cb72-12"><a href="studyII.html#cb72-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb72-13"><a href="studyII.html#cb72-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">3000</span>,</span>
<span id="cb72-14"><a href="studyII.html#cb72-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">show_chain_messages =</span> T</span>
<span id="cb72-15"><a href="studyII.html#cb72-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-16"><a href="studyII.html#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="fu">save_bpc_model</span>(m2_macaque, <span class="st">&#39;m2_macaque&#39;</span>, <span class="st">&#39;./fittedmodels&#39;</span>)</span>
<span id="cb72-17"><a href="studyII.html#cb72-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-18"><a href="studyII.html#cb72-18" aria-hidden="true" tabindex="-1"></a>m2_chip <span class="ot">&lt;-</span></span>
<span id="cb72-19"><a href="studyII.html#cb72-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bpc</span>(</span>
<span id="cb72-20"><a href="studyII.html#cb72-20" aria-hidden="true" tabindex="-1"></a>    chip,</span>
<span id="cb72-21"><a href="studyII.html#cb72-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">player0 =</span> <span class="st">&#39;image1&#39;</span>,</span>
<span id="cb72-22"><a href="studyII.html#cb72-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">player1 =</span> <span class="st">&#39;image2&#39;</span>,</span>
<span id="cb72-23"><a href="studyII.html#cb72-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">cluster =</span> <span class="fu">c</span>(<span class="st">&#39;SubjectCode&#39;</span>),</span>
<span id="cb72-24"><a href="studyII.html#cb72-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">result_column =</span> <span class="st">&#39;y&#39;</span>,</span>
<span id="cb72-25"><a href="studyII.html#cb72-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">model_type =</span> <span class="st">&#39;bt-U&#39;</span>,</span>
<span id="cb72-26"><a href="studyII.html#cb72-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">priors =</span> <span class="fu">list</span>(</span>
<span id="cb72-27"><a href="studyII.html#cb72-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior_lambda_std =</span> <span class="fl">1.0</span>,</span>
<span id="cb72-28"><a href="studyII.html#cb72-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior_U1_std =</span> <span class="fl">1.0</span></span>
<span id="cb72-29"><a href="studyII.html#cb72-29" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb72-30"><a href="studyII.html#cb72-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">3000</span>,</span>
<span id="cb72-31"><a href="studyII.html#cb72-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">show_chain_messages =</span> T</span>
<span id="cb72-32"><a href="studyII.html#cb72-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-33"><a href="studyII.html#cb72-33" aria-hidden="true" tabindex="-1"></a><span class="fu">save_bpc_model</span>(m2_chip, <span class="st">&#39;m2_chip&#39;</span>, <span class="st">&#39;./fittedmodels&#39;</span>)</span>
<span id="cb72-34"><a href="studyII.html#cb72-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-35"><a href="studyII.html#cb72-35" aria-hidden="true" tabindex="-1"></a>m2_gor <span class="ot">&lt;-</span></span>
<span id="cb72-36"><a href="studyII.html#cb72-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bpc</span>(</span>
<span id="cb72-37"><a href="studyII.html#cb72-37" aria-hidden="true" tabindex="-1"></a>    gor,</span>
<span id="cb72-38"><a href="studyII.html#cb72-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">player0 =</span> <span class="st">&#39;image1&#39;</span>,</span>
<span id="cb72-39"><a href="studyII.html#cb72-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">player1 =</span> <span class="st">&#39;image2&#39;</span>,</span>
<span id="cb72-40"><a href="studyII.html#cb72-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">cluster =</span> <span class="fu">c</span>(<span class="st">&#39;SubjectCode&#39;</span>),</span>
<span id="cb72-41"><a href="studyII.html#cb72-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">result_column =</span> <span class="st">&#39;y&#39;</span>,</span>
<span id="cb72-42"><a href="studyII.html#cb72-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">model_type =</span> <span class="st">&#39;bt-U&#39;</span>,</span>
<span id="cb72-43"><a href="studyII.html#cb72-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">priors =</span> <span class="fu">list</span>(</span>
<span id="cb72-44"><a href="studyII.html#cb72-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior_lambda_std =</span> <span class="fl">1.0</span>,</span>
<span id="cb72-45"><a href="studyII.html#cb72-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior_U1_std =</span> <span class="fl">1.0</span></span>
<span id="cb72-46"><a href="studyII.html#cb72-46" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb72-47"><a href="studyII.html#cb72-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">3000</span>,</span>
<span id="cb72-48"><a href="studyII.html#cb72-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">show_chain_messages =</span> T</span>
<span id="cb72-49"><a href="studyII.html#cb72-49" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-50"><a href="studyII.html#cb72-50" aria-hidden="true" tabindex="-1"></a><span class="fu">save_bpc_model</span>(m2_gor, <span class="st">&#39;m2_gor&#39;</span>, <span class="st">&#39;./fittedmodels&#39;</span>)</span></code></pre></div>
<p>Of course we should run diagnostic analysis on the models. For the gorillas</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="studyII.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">launch_shinystan</span>(m2_gor)</span></code></pre></div>
<p>We can also do some quick checks with:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="studyII.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_convergence_diagnostics</span>(m2_chip)</span></code></pre></div>
<pre><code>## Processing csv files: /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106030050-1-3fa7ac.csv, /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106030050-2-3fa7ac.csv, /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106030050-3-3fa7ac.csv, /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106030050-4-3fa7ac.csv
## 
## Checking sampler transitions treedepth.
## Treedepth satisfactory for all transitions.
## 
## Checking sampler transitions for divergences.
## No divergent transitions found.
## 
## Checking E-BFMI - sampler transitions HMC potential energy.
## E-BFMI satisfactory for all transitions.
## 
## Effective sample size satisfactory.
## 
## Split R-hat values satisfactory all parameters.
## 
## Processing complete, no problems detected.</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="studyII.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_convergence_diagnostics</span>(m2_macaque)</span></code></pre></div>
<pre><code>## Processing csv files: /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106021959-1-11945d.csv, /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106021959-2-11945d.csv, /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106021959-3-11945d.csv, /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106021959-4-11945d.csv
## 
## Checking sampler transitions treedepth.
## Treedepth satisfactory for all transitions.
## 
## Checking sampler transitions for divergences.
## No divergent transitions found.
## 
## Checking E-BFMI - sampler transitions HMC potential energy.
## E-BFMI satisfactory for all transitions.
## 
## Effective sample size satisfactory.
## 
## Split R-hat values satisfactory all parameters.
## 
## Processing complete, no problems detected.</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="studyII.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_convergence_diagnostics</span>(m2_gor)</span></code></pre></div>
<pre><code>## Processing csv files: /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106030410-1-75c08b.csv, /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106030410-2-75c08b.csv, /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106030410-3-75c08b.csv, /Users/davidis/Google Drive/Studies/PhD/papers/bpcs-appendix/.bpcs/bt-202106030410-4-75c08b.csv
## 
## Checking sampler transitions treedepth.
## Treedepth satisfactory for all transitions.
## 
## Checking sampler transitions for divergences.
## No divergent transitions found.
## 
## Checking E-BFMI - sampler transitions HMC potential energy.
## E-BFMI satisfactory for all transitions.
## 
## Effective sample size satisfactory.
## 
## Split R-hat values satisfactory all parameters.
## 
## Processing complete, no problems detected.</code></pre>
<div id="getting-the-waic-1" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Getting the WAIC</h3>
<p>Before we start plotting tables let’s get the WAIC for each random effects model and compare with the first models without random effects</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="studyII.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_waic</span>(m2_macaque)</span></code></pre></div>
<pre><code>## 
## Computed from 12000 by 8400 log-likelihood matrix
## 
##           Estimate    SE
## elpd_waic  -3356.3  57.1
## p_waic        32.7   0.8
## waic        6712.6 114.2</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="studyII.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_waic</span>(m2_chip)</span></code></pre></div>
<pre><code>## 
## Computed from 12000 by 5400 log-likelihood matrix
## 
##           Estimate   SE
## elpd_waic  -3360.0 24.1
## p_waic        19.7  0.3
## waic        6720.0 48.3</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="studyII.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_waic</span>(m2_gor)</span></code></pre></div>
<pre><code>## 
## Computed from 12000 by 8100 log-likelihood matrix
## 
##           Estimate   SE
## elpd_waic  -4396.5 40.1
## p_waic        29.5  0.4
## waic        8792.9 80.2</code></pre>
<p>Below I just copied the result of the WAIC into a data frame to create the tables. Of course this process could be automated.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="studyII.html#cb86-1" aria-hidden="true" tabindex="-1"></a>waic_table <span class="ot">&lt;-</span></span>
<span id="cb86-2"><a href="studyII.html#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb86-3"><a href="studyII.html#cb86-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Species =</span> <span class="fu">c</span>(<span class="st">&#39;Macaques&#39;</span>, <span class="st">&#39;Chimpanzees&#39;</span>, <span class="st">&#39;Gorillas&#39;</span>),</span>
<span id="cb86-4"><a href="studyII.html#cb86-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">BT =</span> <span class="fu">c</span>(<span class="fl">7101.5</span>, <span class="fl">7199.4</span>, <span class="fl">9767.2</span>),</span>
<span id="cb86-5"><a href="studyII.html#cb86-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">BTU =</span> <span class="fu">c</span>(<span class="fl">6712.6</span>, <span class="fl">6720.0</span>, <span class="fl">8792.9</span>)</span>
<span id="cb86-6"><a href="studyII.html#cb86-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>The kableExtra package provides some nice tools to create tables from R directly to Latex</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="studyII.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb87-2"><a href="studyII.html#cb87-2" aria-hidden="true" tabindex="-1"></a>  waic_table,  <span class="at">booktabs=</span>T,</span>
<span id="cb87-3"><a href="studyII.html#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">&#39;Comparison of the WAIC of the Bradley-Terry model and the Bradley-Terry model with random effects on the subjects for each specie&#39;</span>,</span>
<span id="cb87-4"><a href="studyII.html#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&#39;Specie&#39;</span>, <span class="st">&#39;Bradley-Terry&#39;</span>, <span class="st">&#39;Bradley-Terry with random effects&#39;</span>)</span>
<span id="cb87-5"><a href="studyII.html#cb87-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb87-6"><a href="studyII.html#cb87-6" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot; &quot;</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">&quot;WAIC&quot;</span> <span class="ot">=</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb87-7"><a href="studyII.html#cb87-7" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-8"><a href="studyII.html#cb87-8" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">&quot;100%&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-60">Table 4.5: </span>Comparison of the WAIC of the Bradley-Terry model and the Bradley-Terry model with random effects on the subjects for each specie
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WAIC
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Specie
</th>
<th style="text-align:right;">
Bradley-Terry
</th>
<th style="text-align:right;">
Bradley-Terry with random effects
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Macaques
</td>
<td style="text-align:right;">
7101.5
</td>
<td style="text-align:right;">
6712.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Chimpanzees
</td>
<td style="text-align:right;">
7199.4
</td>
<td style="text-align:right;">
6720.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Gorillas
</td>
<td style="text-align:right;">
9767.2
</td>
<td style="text-align:right;">
8792.9
</td>
</tr>
</tbody>
</table>
</div>
<p>We can see that the random effects model perform much better than the simple BT model by having a much lower WAIC. Therefore from now we will use only the random effects model to generate our tables and plots</p>
</div>
<div id="parameter-tables-and-plots" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Parameter tables and plots</h3>
<p>Now let’s create some plots and tables to analyze and compare the models</p>
<div id="parameters-table" class="section level4" number="4.3.2.1">
<h4><span class="header-section-number">4.3.2.1</span> Parameters table</h4>
<p>Creating a nice table of the parameters.</p>
<p>First let’s put all species in the same data frame</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="studyII.html#cb88-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">get_parameters</span>(m2_macaque, <span class="at">n_eff =</span> F, <span class="at">keep_par_name =</span> F)</span>
<span id="cb88-2"><a href="studyII.html#cb88-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">get_parameters</span>(m2_chip, <span class="at">n_eff =</span> F, <span class="at">keep_par_name =</span> F)</span>
<span id="cb88-3"><a href="studyII.html#cb88-3" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">get_parameters</span>(m2_gor, <span class="at">n_eff =</span> F, <span class="at">keep_par_name =</span> F)</span>
<span id="cb88-4"><a href="studyII.html#cb88-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-5"><a href="studyII.html#cb88-5" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df1 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Species=</span><span class="st">&#39;Macaque&#39;</span>)</span>
<span id="cb88-6"><a href="studyII.html#cb88-6" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> df2 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Species=</span><span class="st">&#39;Chimpanzees&#39;</span>)</span>
<span id="cb88-7"><a href="studyII.html#cb88-7" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> df3 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Species=</span><span class="st">&#39;Gorilla&#39;</span>)</span>
<span id="cb88-8"><a href="studyII.html#cb88-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-9"><a href="studyII.html#cb88-9" aria-hidden="true" tabindex="-1"></a><span class="co">#appending the dataframes</span></span>
<span id="cb88-10"><a href="studyII.html#cb88-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df1,df2,df3)</span>
<span id="cb88-11"><a href="studyII.html#cb88-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-12"><a href="studyII.html#cb88-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Removing the individual random effects parameters otherwise the table will be much bigger</span></span>
<span id="cb88-13"><a href="studyII.html#cb88-13" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb88-14"><a href="studyII.html#cb88-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">startsWith</span>(Parameter,<span class="st">&#39;U1[&#39;</span>))</span>
<span id="cb88-15"><a href="studyII.html#cb88-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-16"><a href="studyII.html#cb88-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>Now let’s create the table by removing the species column and adding some row Headers for the species</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="studyII.html#cb89-1" aria-hidden="true" tabindex="-1"></a>(df <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Species) <span class="sc">%&gt;%</span> </span>
<span id="cb89-2"><a href="studyII.html#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>( <span class="at">caption =</span> <span class="st">&#39;Parameters of the model with random effects&#39;</span>, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&#39;Parameter&#39;</span>, <span class="st">&#39;Mean&#39;</span>, <span class="st">&#39;Median&#39;</span>, <span class="st">&#39;HPD lower&#39;</span>, <span class="st">&#39;HPD upper&#39;</span>), <span class="at">row.names =</span> <span class="cn">NA</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb89-3"><a href="studyII.html#cb89-3" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb89-4"><a href="studyII.html#cb89-4" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="st">&quot;Macaque&quot;</span>, <span class="dv">1</span>, <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-5"><a href="studyII.html#cb89-5" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="st">&quot;Chimpanzees&quot;</span>, <span class="dv">7</span>, <span class="dv">13</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb89-6"><a href="studyII.html#cb89-6" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="st">&quot;Gorilla&quot;</span>, <span class="dv">14</span>, <span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb89-7"><a href="studyII.html#cb89-7" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">&quot;100%&quot;</span>)</span>
<span id="cb89-8"><a href="studyII.html#cb89-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-63">Table 4.6: </span>Parameters of the model with random effects
</caption>
<thead>
<tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
Median
</th>
<th style="text-align:right;">
HPD lower
</th>
<th style="text-align:right;">
HPD upper
</th>
</tr>
</thead>
<tbody>
<tr grouplength="6">
<td colspan="5" style="border-bottom: 1px solid;">
<strong>Macaque</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Carrot
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
-0.74
</td>
<td style="text-align:right;">
1.04
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Celery
</td>
<td style="text-align:right;">
-2.28
</td>
<td style="text-align:right;">
-2.29
</td>
<td style="text-align:right;">
-3.17
</td>
<td style="text-align:right;">
-1.39
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Jungle Pellet
</td>
<td style="text-align:right;">
1.23
</td>
<td style="text-align:right;">
1.23
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
2.15
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Oats
</td>
<td style="text-align:right;">
-0.90
</td>
<td style="text-align:right;">
-0.90
</td>
<td style="text-align:right;">
-1.77
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Peanuts
</td>
<td style="text-align:right;">
2.01
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:right;">
1.14
</td>
<td style="text-align:right;">
2.92
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Green Beans
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
-1.05
</td>
<td style="text-align:right;">
0.76
</td>
</tr>
<tr grouplength="7">
<td colspan="5" style="border-bottom: 1px solid;">
<strong>Chimpanzees</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
U1_std
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;">
0.42
</td>
<td style="text-align:right;">
0.75
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Apple
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.97
</td>
<td style="text-align:right;">
1.08
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Tomato
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
-0.70
</td>
<td style="text-align:right;">
1.34
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Carrot
</td>
<td style="text-align:right;">
-0.21
</td>
<td style="text-align:right;">
-0.21
</td>
<td style="text-align:right;">
-1.25
</td>
<td style="text-align:right;">
0.77
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Grape
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
-0.38
</td>
<td style="text-align:right;">
1.69
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Cucumber
</td>
<td style="text-align:right;">
-0.32
</td>
<td style="text-align:right;">
-0.33
</td>
<td style="text-align:right;">
-1.36
</td>
<td style="text-align:right;">
0.67
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Turnip
</td>
<td style="text-align:right;">
-0.43
</td>
<td style="text-align:right;">
-0.43
</td>
<td style="text-align:right;">
-1.43
</td>
<td style="text-align:right;">
0.59
</td>
</tr>
<tr grouplength="7">
<td colspan="5" style="border-bottom: 1px solid;">
<strong>Gorilla</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
U1_std
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;">
0.70
</td>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
1.01
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Apple
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.95
</td>
<td style="text-align:right;">
0.99
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Carrot
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
-1.10
</td>
<td style="text-align:right;">
0.84
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Grape
</td>
<td style="text-align:right;">
0.86
</td>
<td style="text-align:right;">
0.87
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
1.81
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Tomato
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;">
0.86
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
1.85
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Cucumber
</td>
<td style="text-align:right;">
-0.70
</td>
<td style="text-align:right;">
-0.70
</td>
<td style="text-align:right;">
-1.67
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Turnip
</td>
<td style="text-align:right;">
-0.94
</td>
<td style="text-align:right;">
-0.94
</td>
<td style="text-align:right;">
-1.93
</td>
<td style="text-align:right;">
0.04
</td>
</tr>
<tr>
<td style="text-align:left;">
U1_std
</td>
<td style="text-align:right;">
0.78
</td>
<td style="text-align:right;">
0.77
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;">
1.02
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="rank-table" class="section level4" number="4.3.2.2">
<h4><span class="header-section-number">4.3.2.2</span> Rank table</h4>
<p>Rank of the food preferences</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="studyII.html#cb90-1" aria-hidden="true" tabindex="-1"></a>rank1 <span class="ot">&lt;-</span> <span class="fu">get_rank_of_players_df</span>(m2_macaque)</span>
<span id="cb90-2"><a href="studyII.html#cb90-2" aria-hidden="true" tabindex="-1"></a>rank2 <span class="ot">&lt;-</span> <span class="fu">get_rank_of_players_df</span>(m2_chip)</span>
<span id="cb90-3"><a href="studyII.html#cb90-3" aria-hidden="true" tabindex="-1"></a>rank3 <span class="ot">&lt;-</span> <span class="fu">get_rank_of_players_df</span>(m2_gor)</span>
<span id="cb90-4"><a href="studyII.html#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="studyII.html#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="co">#appending the dataframes</span></span>
<span id="cb90-6"><a href="studyII.html#cb90-6" aria-hidden="true" tabindex="-1"></a>rank_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(rank1,rank2,rank3)</span></code></pre></div>
<p>Now let’s create the rank table</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="studyII.html#cb91-1" aria-hidden="true" tabindex="-1"></a>(rank_all <span class="sc">%&gt;%</span> </span>
<span id="cb91-2"><a href="studyII.html#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>( <span class="at">caption =</span> <span class="st">&#39;Ranking of the food preferences per specie with model with random effects&#39;</span>, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&#39;Food&#39;</span>, <span class="st">&#39;Median Rank&#39;</span>, <span class="st">&#39;Mean Rank&#39;</span>, <span class="st">&#39;Std. Rank&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-3"><a href="studyII.html#cb91-3" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-4"><a href="studyII.html#cb91-4" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="st">&quot;Macaque&quot;</span>, <span class="dv">1</span>, <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-5"><a href="studyII.html#cb91-5" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="st">&quot;Chimpanzees&quot;</span>, <span class="dv">7</span>, <span class="dv">12</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb91-6"><a href="studyII.html#cb91-6" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="st">&quot;Gorilla&quot;</span>, <span class="dv">13</span>, <span class="dv">18</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb91-7"><a href="studyII.html#cb91-7" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">&quot;100%&quot;</span>)</span>
<span id="cb91-8"><a href="studyII.html#cb91-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-66">Table 4.7: </span>Ranking of the food preferences per specie with model with random effects
</caption>
<thead>
<tr>
<th style="text-align:left;">
Food
</th>
<th style="text-align:right;">
Median Rank
</th>
<th style="text-align:right;">
Mean Rank
</th>
<th style="text-align:right;">
Std. Rank
</th>
</tr>
</thead>
<tbody>
<tr grouplength="6">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>Macaque</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Peanuts
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.01
</td>
<td style="text-align:right;">
0.09
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Jungle Pellet
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.99
</td>
<td style="text-align:right;">
0.09
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Carrot
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3.16
</td>
<td style="text-align:right;">
0.37
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Green Beans
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3.85
</td>
<td style="text-align:right;">
0.38
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Oats
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4.99
</td>
<td style="text-align:right;">
0.09
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Celery
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr grouplength="6">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>Chimpanzees</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Grape
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.51
</td>
<td style="text-align:right;">
0.86
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Tomato
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2.26
</td>
<td style="text-align:right;">
1.10
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Apple
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3.36
</td>
<td style="text-align:right;">
1.26
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Carrot
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4.23
</td>
<td style="text-align:right;">
1.25
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Cucumber
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4.62
</td>
<td style="text-align:right;">
1.24
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Turnip
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5.02
</td>
<td style="text-align:right;">
1.10
</td>
</tr>
<tr grouplength="6">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>Gorilla</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Tomato
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.54
</td>
<td style="text-align:right;">
0.58
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Grape
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.57
</td>
<td style="text-align:right;">
0.61
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Apple
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3.37
</td>
<td style="text-align:right;">
0.68
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Carrot
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3.71
</td>
<td style="text-align:right;">
0.71
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Cucumber
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5.20
</td>
<td style="text-align:right;">
0.67
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Turnip
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5.63
</td>
<td style="text-align:right;">
0.57
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="plot" class="section level4" number="4.3.2.3">
<h4><span class="header-section-number">4.3.2.3</span> Plot</h4>
<p>Now let’s use ggplot to create a plot comparing both types of model. The simple BT and the BT with Random effects</p>
<p>First we need to prepare the data frames for plotting. For the simple BT model (called old)</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="studyII.html#cb92-1" aria-hidden="true" tabindex="-1"></a>df1_old <span class="ot">&lt;-</span> <span class="fu">get_parameters</span>(m1_macaque, <span class="at">n_eff =</span> F, <span class="at">keep_par_name =</span> F)</span>
<span id="cb92-2"><a href="studyII.html#cb92-2" aria-hidden="true" tabindex="-1"></a>df2_old <span class="ot">&lt;-</span> <span class="fu">get_parameters</span>(m1_chip, <span class="at">n_eff =</span> F, <span class="at">keep_par_name =</span> F)</span>
<span id="cb92-3"><a href="studyII.html#cb92-3" aria-hidden="true" tabindex="-1"></a>df3_old <span class="ot">&lt;-</span> <span class="fu">get_parameters</span>(m1_gor, <span class="at">n_eff =</span> F, <span class="at">keep_par_name =</span> F)</span>
<span id="cb92-4"><a href="studyII.html#cb92-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-5"><a href="studyII.html#cb92-5" aria-hidden="true" tabindex="-1"></a>df1_old <span class="ot">&lt;-</span> df1_old <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Species=</span><span class="st">&#39;Macaque&#39;</span>, <span class="at">Model=</span><span class="st">&#39;Simple&#39;</span>)</span>
<span id="cb92-6"><a href="studyII.html#cb92-6" aria-hidden="true" tabindex="-1"></a>df2_old <span class="ot">&lt;-</span> df2_old <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Species=</span><span class="st">&#39;Chimpanzees&#39;</span>, <span class="at">Model=</span><span class="st">&#39;Simple&#39;</span>)</span>
<span id="cb92-7"><a href="studyII.html#cb92-7" aria-hidden="true" tabindex="-1"></a>df3_old <span class="ot">&lt;-</span> df3_old <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Species=</span><span class="st">&#39;Gorilla&#39;</span>, <span class="at">Model=</span><span class="st">&#39;Simple&#39;</span>)</span>
<span id="cb92-8"><a href="studyII.html#cb92-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-9"><a href="studyII.html#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="co">#appending the dataframes</span></span>
<span id="cb92-10"><a href="studyII.html#cb92-10" aria-hidden="true" tabindex="-1"></a>df_old <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df1_old,df2_old,df3_old)</span>
<span id="cb92-11"><a href="studyII.html#cb92-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-12"><a href="studyII.html#cb92-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Removing the individual random effects parameters</span></span>
<span id="cb92-13"><a href="studyII.html#cb92-13" aria-hidden="true" tabindex="-1"></a>df_old <span class="ot">&lt;-</span> df_old <span class="sc">%&gt;%</span> </span>
<span id="cb92-14"><a href="studyII.html#cb92-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">startsWith</span>(Parameter,<span class="st">&#39;U&#39;</span>))</span>
<span id="cb92-15"><a href="studyII.html#cb92-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df_old) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>For the BT with random effects</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="studyII.html#cb93-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">get_parameters</span>(m2_macaque, <span class="at">n_eff =</span> F, <span class="at">keep_par_name =</span> F)</span>
<span id="cb93-2"><a href="studyII.html#cb93-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">get_parameters</span>(m2_chip, <span class="at">n_eff =</span> F, <span class="at">keep_par_name =</span> F)</span>
<span id="cb93-3"><a href="studyII.html#cb93-3" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">get_parameters</span>(m2_gor, <span class="at">n_eff =</span> F, <span class="at">keep_par_name =</span> F)</span>
<span id="cb93-4"><a href="studyII.html#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="studyII.html#cb93-5" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df1 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Species=</span><span class="st">&#39;Macaque&#39;</span>, <span class="at">Model=</span><span class="st">&#39;RandomEffects&#39;</span>)</span>
<span id="cb93-6"><a href="studyII.html#cb93-6" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> df2 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Species=</span><span class="st">&#39;Chimpanzees&#39;</span>, <span class="at">Model=</span><span class="st">&#39;RandomEffects&#39;</span>)</span>
<span id="cb93-7"><a href="studyII.html#cb93-7" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> df3 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Species=</span><span class="st">&#39;Gorilla&#39;</span>, <span class="at">Model=</span><span class="st">&#39;RandomEffects&#39;</span>)</span>
<span id="cb93-8"><a href="studyII.html#cb93-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-9"><a href="studyII.html#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="co">#appending the dataframes</span></span>
<span id="cb93-10"><a href="studyII.html#cb93-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df1,df2,df3)</span>
<span id="cb93-11"><a href="studyII.html#cb93-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-12"><a href="studyII.html#cb93-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Removing the individual random effects parameters</span></span>
<span id="cb93-13"><a href="studyII.html#cb93-13" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb93-14"><a href="studyII.html#cb93-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">startsWith</span>(Parameter,<span class="st">&#39;U&#39;</span>))</span>
<span id="cb93-15"><a href="studyII.html#cb93-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>Now we can merge them in a single data frame for ggplot</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="studyII.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">#appending the dataframes</span></span>
<span id="cb94-2"><a href="studyII.html#cb94-2" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df, df_old)</span>
<span id="cb94-3"><a href="studyII.html#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="co">#To order in ggplot we need to specify the order in the levels. We want to place the first model first and the random effects second</span></span>
<span id="cb94-4"><a href="studyII.html#cb94-4" aria-hidden="true" tabindex="-1"></a>out<span class="sc">$</span>Model<span class="ot">&lt;-</span><span class="fu">factor</span>(out<span class="sc">$</span>Model, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&#39;Simple&#39;</span>,<span class="st">&#39;RandomEffects&#39;</span>))</span>
<span id="cb94-5"><a href="studyII.html#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="studyII.html#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining a black-gray palette:</span></span>
<span id="cb94-7"><a href="studyII.html#cb94-7" aria-hidden="true" tabindex="-1"></a>cbp1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#000000&quot;</span>, <span class="st">&quot;#999999&quot;</span>)</span>
<span id="cb94-8"><a href="studyII.html#cb94-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-9"><a href="studyII.html#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Using the pointrange function to define the HPD intervals</span></span>
<span id="cb94-10"><a href="studyII.html#cb94-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(out, <span class="fu">aes</span>(<span class="at">x=</span>Parameter))<span class="sc">+</span></span>
<span id="cb94-11"><a href="studyII.html#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(</span>
<span id="cb94-12"><a href="studyII.html#cb94-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymin =</span> HPD_lower,</span>
<span id="cb94-13"><a href="studyII.html#cb94-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymax =</span> HPD_higher,</span>
<span id="cb94-14"><a href="studyII.html#cb94-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> Mean,</span>
<span id="cb94-15"><a href="studyII.html#cb94-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">group=</span>Model, </span>
<span id="cb94-16"><a href="studyII.html#cb94-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">color=</span>Model),</span>
<span id="cb94-17"><a href="studyII.html#cb94-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="at">width=</span><span class="dv">1</span>))<span class="sc">+</span> <span class="co">#separating the two models (so they are not plotted overlapping)</span></span>
<span id="cb94-18"><a href="studyII.html#cb94-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Parameters estimates with uncertainty (HPD) interval&#39;</span>,</span>
<span id="cb94-19"><a href="studyII.html#cb94-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Worth value&#39;</span>,</span>
<span id="cb94-20"><a href="studyII.html#cb94-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&#39;Food&#39;</span>)<span class="sc">+</span></span>
<span id="cb94-21"><a href="studyII.html#cb94-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>Species) <span class="sc">+</span> <span class="co">#Dividing the plot into three by species</span></span>
<span id="cb94-22"><a href="studyII.html#cb94-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span> <span class="co"># A black and white theme</span></span>
<span id="cb94-23"><a href="studyII.html#cb94-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_x_discrete(guide = guide_axis(n.dodge = 2)) +</span></span>
<span id="cb94-24"><a href="studyII.html#cb94-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb94-25"><a href="studyII.html#cb94-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))<span class="sc">+</span><span class="co">#small adjustments to the theme</span></span>
<span id="cb94-26"><a href="studyII.html#cb94-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> cbp1) <span class="co">#applying the color palette</span></span></code></pre></div>
<p><img src="bpcs-appendix_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
</div>
<div id="probability-of-selecting-a-novel-stimuli" class="section level4" number="4.3.2.4">
<h4><span class="header-section-number">4.3.2.4</span> Probability of selecting a novel stimuli</h4>
<p>We will create a the table of the predictions of selecting a novel stimuli (compared to the trained ones). This is replication of table II of the original paper (of course the results are not the same since we are using different models and estimation values)</p>
<p>For that, we first create a data frame of the new predictions for each species. Since our model uses random effects and we would need to specify each random effect to make the predictions we will do something slightly different. We will consider that the random effects will be zero, that is, which is equivalent to the average value of the random effects (remember that it has a mean of zero). One way to achieve this is by using the obtained coefficients in a submodel. This can be done in the bpcs package by using the model_type option.</p>
<p>We ask for the data frame instead of the table because we will assemble the table manually.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="studyII.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with all the pairs of food that we want to calculate</span></span>
<span id="cb95-2"><a href="studyII.html#cb95-2" aria-hidden="true" tabindex="-1"></a>pairs_gor <span class="ot">&lt;-</span></span>
<span id="cb95-3"><a href="studyII.html#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb95-4"><a href="studyII.html#cb95-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">image2 =</span> <span class="fu">c</span>(</span>
<span id="cb95-5"><a href="studyII.html#cb95-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Apple&#39;</span>,</span>
<span id="cb95-6"><a href="studyII.html#cb95-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Apple&#39;</span>,</span>
<span id="cb95-7"><a href="studyII.html#cb95-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Apple&#39;</span>,</span>
<span id="cb95-8"><a href="studyII.html#cb95-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Apple&#39;</span>,</span>
<span id="cb95-9"><a href="studyII.html#cb95-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Tomato&#39;</span>,</span>
<span id="cb95-10"><a href="studyII.html#cb95-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Tomato&#39;</span>,</span>
<span id="cb95-11"><a href="studyII.html#cb95-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Tomato&#39;</span>,</span>
<span id="cb95-12"><a href="studyII.html#cb95-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Tomato&#39;</span></span>
<span id="cb95-13"><a href="studyII.html#cb95-13" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb95-14"><a href="studyII.html#cb95-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">image1 =</span> <span class="fu">c</span>(</span>
<span id="cb95-15"><a href="studyII.html#cb95-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Cucumber&#39;</span>,</span>
<span id="cb95-16"><a href="studyII.html#cb95-16" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Grape&#39;</span>,</span>
<span id="cb95-17"><a href="studyII.html#cb95-17" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Turnip&#39;</span>,</span>
<span id="cb95-18"><a href="studyII.html#cb95-18" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Carrot&#39;</span>,</span>
<span id="cb95-19"><a href="studyII.html#cb95-19" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Cucumber&#39;</span>,</span>
<span id="cb95-20"><a href="studyII.html#cb95-20" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Grape&#39;</span>,</span>
<span id="cb95-21"><a href="studyII.html#cb95-21" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Turnip&#39;</span>,</span>
<span id="cb95-22"><a href="studyII.html#cb95-22" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Carrot&#39;</span></span>
<span id="cb95-23"><a href="studyII.html#cb95-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb95-24"><a href="studyII.html#cb95-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb95-25"><a href="studyII.html#cb95-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-26"><a href="studyII.html#cb95-26" aria-hidden="true" tabindex="-1"></a>pairs_chip <span class="ot">&lt;-</span></span>
<span id="cb95-27"><a href="studyII.html#cb95-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb95-28"><a href="studyII.html#cb95-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">image2 =</span> <span class="fu">c</span>(</span>
<span id="cb95-29"><a href="studyII.html#cb95-29" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Apple&#39;</span>,</span>
<span id="cb95-30"><a href="studyII.html#cb95-30" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Apple&#39;</span>,</span>
<span id="cb95-31"><a href="studyII.html#cb95-31" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Apple&#39;</span>,</span>
<span id="cb95-32"><a href="studyII.html#cb95-32" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Apple&#39;</span>,</span>
<span id="cb95-33"><a href="studyII.html#cb95-33" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Tomato&#39;</span>,</span>
<span id="cb95-34"><a href="studyII.html#cb95-34" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Tomato&#39;</span>,</span>
<span id="cb95-35"><a href="studyII.html#cb95-35" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Tomato&#39;</span>,</span>
<span id="cb95-36"><a href="studyII.html#cb95-36" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Tomato&#39;</span></span>
<span id="cb95-37"><a href="studyII.html#cb95-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb95-38"><a href="studyII.html#cb95-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">image1 =</span> <span class="fu">c</span>(</span>
<span id="cb95-39"><a href="studyII.html#cb95-39" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Cucumber&#39;</span>,</span>
<span id="cb95-40"><a href="studyII.html#cb95-40" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Grape&#39;</span>,</span>
<span id="cb95-41"><a href="studyII.html#cb95-41" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Turnip&#39;</span>,</span>
<span id="cb95-42"><a href="studyII.html#cb95-42" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Carrot&#39;</span>,</span>
<span id="cb95-43"><a href="studyII.html#cb95-43" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Cucumber&#39;</span>,</span>
<span id="cb95-44"><a href="studyII.html#cb95-44" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Grape&#39;</span>,</span>
<span id="cb95-45"><a href="studyII.html#cb95-45" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Turnip&#39;</span>,</span>
<span id="cb95-46"><a href="studyII.html#cb95-46" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Carrot&#39;</span></span>
<span id="cb95-47"><a href="studyII.html#cb95-47" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb95-48"><a href="studyII.html#cb95-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb95-49"><a href="studyII.html#cb95-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-50"><a href="studyII.html#cb95-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-51"><a href="studyII.html#cb95-51" aria-hidden="true" tabindex="-1"></a>pairs_macaque <span class="ot">&lt;-</span></span>
<span id="cb95-52"><a href="studyII.html#cb95-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb95-53"><a href="studyII.html#cb95-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">image1 =</span> <span class="fu">c</span>(</span>
<span id="cb95-54"><a href="studyII.html#cb95-54" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Oats&#39;</span>,</span>
<span id="cb95-55"><a href="studyII.html#cb95-55" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Oats&#39;</span>,</span>
<span id="cb95-56"><a href="studyII.html#cb95-56" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Oats&#39;</span>,</span>
<span id="cb95-57"><a href="studyII.html#cb95-57" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Oats&#39;</span>,</span>
<span id="cb95-58"><a href="studyII.html#cb95-58" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Green Beans&#39;</span>,</span>
<span id="cb95-59"><a href="studyII.html#cb95-59" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Green Beans&#39;</span>,</span>
<span id="cb95-60"><a href="studyII.html#cb95-60" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Green Beans&#39;</span>,</span>
<span id="cb95-61"><a href="studyII.html#cb95-61" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Green Beans&#39;</span></span>
<span id="cb95-62"><a href="studyII.html#cb95-62" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb95-63"><a href="studyII.html#cb95-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">image2 =</span> <span class="fu">c</span>(</span>
<span id="cb95-64"><a href="studyII.html#cb95-64" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Celery&#39;</span>,</span>
<span id="cb95-65"><a href="studyII.html#cb95-65" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Jungle Pellet&#39;</span>,</span>
<span id="cb95-66"><a href="studyII.html#cb95-66" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Peanuts&#39;</span>,</span>
<span id="cb95-67"><a href="studyII.html#cb95-67" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Carrot&#39;</span>,</span>
<span id="cb95-68"><a href="studyII.html#cb95-68" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Celery&#39;</span>,</span>
<span id="cb95-69"><a href="studyII.html#cb95-69" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Jungle Pellet&#39;</span>,</span>
<span id="cb95-70"><a href="studyII.html#cb95-70" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Peanuts&#39;</span>,</span>
<span id="cb95-71"><a href="studyII.html#cb95-71" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Carrot&#39;</span></span>
<span id="cb95-72"><a href="studyII.html#cb95-72" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb95-73"><a href="studyII.html#cb95-73" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb95-74"><a href="studyII.html#cb95-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-75"><a href="studyII.html#cb95-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-76"><a href="studyII.html#cb95-76" aria-hidden="true" tabindex="-1"></a>prob_chip <span class="ot">&lt;-</span></span>
<span id="cb95-77"><a href="studyII.html#cb95-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_probabilities_df</span>(</span>
<span id="cb95-78"><a href="studyII.html#cb95-78" aria-hidden="true" tabindex="-1"></a>    m2_chip, </span>
<span id="cb95-79"><a href="studyII.html#cb95-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> pairs_chip,</span>
<span id="cb95-80"><a href="studyII.html#cb95-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">model_type =</span> <span class="st">&#39;bt&#39;</span>)</span>
<span id="cb95-81"><a href="studyII.html#cb95-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-82"><a href="studyII.html#cb95-82" aria-hidden="true" tabindex="-1"></a>prob_macaque <span class="ot">&lt;-</span></span>
<span id="cb95-83"><a href="studyII.html#cb95-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_probabilities_df</span>(</span>
<span id="cb95-84"><a href="studyII.html#cb95-84" aria-hidden="true" tabindex="-1"></a>    m2_macaque, </span>
<span id="cb95-85"><a href="studyII.html#cb95-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> pairs_macaque, </span>
<span id="cb95-86"><a href="studyII.html#cb95-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">model_type =</span> <span class="st">&#39;bt&#39;</span>)</span>
<span id="cb95-87"><a href="studyII.html#cb95-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-88"><a href="studyII.html#cb95-88" aria-hidden="true" tabindex="-1"></a>prob_gor <span class="ot">&lt;-</span></span>
<span id="cb95-89"><a href="studyII.html#cb95-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_probabilities_df</span>(</span>
<span id="cb95-90"><a href="studyII.html#cb95-90" aria-hidden="true" tabindex="-1"></a>    m2_gor, </span>
<span id="cb95-91"><a href="studyII.html#cb95-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> pairs_gor, </span>
<span id="cb95-92"><a href="studyII.html#cb95-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">model_type =</span> <span class="st">&#39;bt&#39;</span>)</span>
<span id="cb95-93"><a href="studyII.html#cb95-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-94"><a href="studyII.html#cb95-94" aria-hidden="true" tabindex="-1"></a><span class="co">#merging in a single df</span></span>
<span id="cb95-95"><a href="studyII.html#cb95-95" aria-hidden="true" tabindex="-1"></a>prob_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(prob_gor, prob_chip, prob_macaque)</span>
<span id="cb95-96"><a href="studyII.html#cb95-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-97"><a href="studyII.html#cb95-97" aria-hidden="true" tabindex="-1"></a><span class="co">#since this is  a time consuming table to make let&#39;s also save it</span></span>
<span id="cb95-98"><a href="studyII.html#cb95-98" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(prob_table, <span class="st">&#39;prob_table.RDS&#39;</span>)</span></code></pre></div>
<p>Now we can create the table</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="studyII.html#cb96-1" aria-hidden="true" tabindex="-1"></a>prob_table <span class="ot">&lt;-</span> prob_table <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="studyII.html#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Probability =</span> i_beats_j,</span>
<span id="cb96-3"><a href="studyII.html#cb96-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">OddsRatio =</span> Probability <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> Probability))</span>
<span id="cb96-4"><a href="studyII.html#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="studyII.html#cb96-5" aria-hidden="true" tabindex="-1"></a>prob_table <span class="sc">%&gt;%</span></span>
<span id="cb96-6"><a href="studyII.html#cb96-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(i, j, Probability, OddsRatio) <span class="sc">%&gt;%</span></span>
<span id="cb96-7"><a href="studyII.html#cb96-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb96-8"><a href="studyII.html#cb96-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&#39;Posterior probabilities of the novel stimuli i being selected over the trained stimuli j&#39;</span>,</span>
<span id="cb96-9"><a href="studyII.html#cb96-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">booktabs =</span> T,</span>
<span id="cb96-10"><a href="studyII.html#cb96-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb96-11"><a href="studyII.html#cb96-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&#39;Item i&#39;</span>, <span class="st">&#39;Item j&#39;</span>, <span class="st">&#39;Probability&#39;</span>, <span class="st">&#39;Odds Ratio&#39;</span>)</span>
<span id="cb96-12"><a href="studyII.html#cb96-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb96-13"><a href="studyII.html#cb96-13" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb96-14"><a href="studyII.html#cb96-14" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="st">&quot;Gorilla&quot;</span>, <span class="dv">1</span>, <span class="dv">8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-15"><a href="studyII.html#cb96-15" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="st">&quot;Chimpanzee&quot;</span>, <span class="dv">9</span>, <span class="dv">16</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-16"><a href="studyII.html#cb96-16" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="st">&quot;Macaque&quot;</span>, <span class="dv">17</span>, <span class="dv">24</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb96-17"><a href="studyII.html#cb96-17" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">&quot;100%&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-73">Table 4.8: </span>Posterior probabilities of the novel stimuli i being selected over the trained stimuli j
</caption>
<thead>
<tr>
<th style="text-align:left;">
Item i
</th>
<th style="text-align:left;">
Item j
</th>
<th style="text-align:right;">
Probability
</th>
<th style="text-align:right;">
Odds Ratio
</th>
</tr>
</thead>
<tbody>
<tr grouplength="8">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>Gorilla</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Apple
</td>
<td style="text-align:left;">
Cucumber
</td>
<td style="text-align:right;">
0.66
</td>
<td style="text-align:right;">
1.94
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Apple
</td>
<td style="text-align:left;">
Grape
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Apple
</td>
<td style="text-align:left;">
Turnip
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;">
2.03
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Apple
</td>
<td style="text-align:left;">
Carrot
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
1.27
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Tomato
</td>
<td style="text-align:left;">
Cucumber
</td>
<td style="text-align:right;">
0.84
</td>
<td style="text-align:right;">
5.25
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Tomato
</td>
<td style="text-align:left;">
Grape
</td>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
0.92
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Tomato
</td>
<td style="text-align:left;">
Turnip
</td>
<td style="text-align:right;">
0.84
</td>
<td style="text-align:right;">
5.25
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Tomato
</td>
<td style="text-align:left;">
Carrot
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
4.00
</td>
</tr>
<tr grouplength="8">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>Chimpanzee</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Apple
</td>
<td style="text-align:left;">
Cucumber
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;">
1.86
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Apple
</td>
<td style="text-align:left;">
Grape
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0.67
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Apple
</td>
<td style="text-align:left;">
Turnip
</td>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;">
1.44
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Apple
</td>
<td style="text-align:left;">
Carrot
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
1.38
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Tomato
</td>
<td style="text-align:left;">
Cucumber
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;">
1.86
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Tomato
</td>
<td style="text-align:left;">
Grape
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0.67
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Tomato
</td>
<td style="text-align:left;">
Turnip
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;">
1.56
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Tomato
</td>
<td style="text-align:left;">
Carrot
</td>
<td style="text-align:right;">
0.68
</td>
<td style="text-align:right;">
2.13
</td>
</tr>
<tr grouplength="8">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>Macaque</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Oats
</td>
<td style="text-align:left;">
Celery
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Oats
</td>
<td style="text-align:left;">
Jungle Pellet
</td>
<td style="text-align:right;">
0.87
</td>
<td style="text-align:right;">
6.69
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Oats
</td>
<td style="text-align:left;">
Peanuts
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
24.00
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Oats
</td>
<td style="text-align:left;">
Carrot
</td>
<td style="text-align:right;">
0.73
</td>
<td style="text-align:right;">
2.70
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Green Beans
</td>
<td style="text-align:left;">
Celery
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Green Beans
</td>
<td style="text-align:left;">
Jungle Pellet
</td>
<td style="text-align:right;">
0.73
</td>
<td style="text-align:right;">
2.70
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Green Beans
</td>
<td style="text-align:left;">
Peanuts
</td>
<td style="text-align:right;">
0.89
</td>
<td style="text-align:right;">
8.09
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Green Beans
</td>
<td style="text-align:left;">
Carrot
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;">
1.33
</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="studyI.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="studyIII.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
